# Docker Compose for safe Claude Code development
# Usage: docker-compose -f docker/docker-compose.dev.yml up -d
# Then: docker exec -it nivasesa-dev bash
# Inside container: claude --dangerously-skip-permissions

version: '3.8'

services:
  dev:
    container_name: nivasesa-dev
    build:
      context: ..
      dockerfile: docker/Dockerfile.dev
    volumes:
      # Mount source code (changes persist)
      - ..:/app
      # Preserve node_modules from container
      - node_modules:/app/node_modules
      # Mount Claude config
      - ~/.claude:/home/developer/.claude:ro
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=development
      - DATABASE_URL=file:./prisma/dev.db
    stdin_open: true
    tty: true
    # Limit resources for safety
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 4G

volumes:
  node_modules:
